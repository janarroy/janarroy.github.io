<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Travel â€“ Jan Arroyo</title>
<link href="styles.css" rel="stylesheet" />

<style>
  :root{
    --bg-cream:#fff7ed;
    --paper:#fffdfa;
    --ink:#0f172a;
    --muted:#6b7280;
    --line:rgba(17,24,39,.10);
    --shadow:0 10px 30px rgba(17,24,39,.12);
    --header:#f3d8b3;
    --bezier:cubic-bezier(.22,.61,.36,1);
    --accent:#b91c1c;
    /* from index.html â€” controls how far WORK is shifted right */
    --work-shift: 650px;
  }

  html,body{
    margin:0;padding:0;
    background:
      radial-gradient(circle at 1px 1px,#e8ecf1 1.2px,rgba(255,255,255,0) 1.3px) 0 0/12px 12px,
      #fafbfc;
    color:var(--ink);
    min-height:100dvh; overflow-x:hidden;
    font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial;
  }

  .container{max-width:1120px;margin:0 auto;padding:8px 20px 100px}

  /* ===== Sticky nav â€” copied from index.html ===== */
  header.navbar{
    position:sticky; top:24px; z-index:20;
    background:transparent; border-bottom:none; backdrop-filter:none;
  }
/* Sticky nav â€” same as index/races */
header.navbar .container{
  width:100%;
  /* add these two lines */
  max-width: 1040px;
  margin: 0 auto;

  padding:0 40px;
}

  .nav-inner{display:flex;align-items:center;justify-content:space-between;padding:18px 0 8px}

  .brand{display:flex;align-items:center;gap:10px;text-decoration:none;color:inherit;font-weight:700}
  .brand img{width:30px;height:30px;border-radius:8px;object-fit:cover}
  .brand span{display:none;}

  /* Keep brand left, dropdown on right, and shift WORK toward dropdown (exactly like index) */
  .nav-links{ position:relative; display:flex; align-items:center; gap:16px; width:100%; }
  .nav-links > a:first-child{
    position:absolute;
    left:50%;
    transform: translateX(calc(-50% + var(--work-shift)));
    font-weight:800; font-size:14.5px; letter-spacing:.2px;
    text-decoration:none; color:#111827;
  }
  .nav-links > .dropdown{ margin-left:auto; }
  .nav-links a,
  .nav-links button{
    color:#111827; text-decoration:none; font-weight:700; font-size:14.5px; letter-spacing:.2px;
    background:none; border:none; padding:0; cursor:pointer;
  }
  .nav-links a:hover, .nav-links button:hover{opacity:.75}

  /* Dropdown */
  .dropdown{position:relative}
  .dropdown-menu{
    position:absolute; right:0; top:140%;
    background:#fff; border:1px solid #e5e7eb; border-radius:10px;
    box-shadow:0 10px 30px rgba(17,19,24,.10); min-width:180px; padding:8px; display:none;
  }
  .dropdown-menu a{
    display:block; padding:10px 12px; border-radius:8px; font-weight:600; font-size:14px; color:#111827; text-decoration:none;
  }
  .dropdown-menu a:hover{background:#f8fafc}
  .dropdown[aria-expanded="true"] .dropdown-menu{display:block}

  /* Active (red + star) â€” same as index */
  .nav-links .active{ color:var(--accent); position:relative; }
  .nav-links .active::before{
    content:"âœ¦"; position:absolute; top:-14px; left:50%; transform:translateX(-50%);
    font-size:12px; line-height:1; color:var(--accent); opacity:.95;
  }

  /* ===== Page-specific styles (unchanged) ===== */
  .scene{position:fixed;inset:0;z-index:0;pointer-events:none;opacity:.9}
  .route-dash{stroke:rgba(17,24,39,.22);stroke-width:1.6;stroke-dasharray:7 9;fill:none}

  .ticket{
    margin:8px 0 2px; border-radius:26px; overflow:hidden;
    box-shadow:var(--shadow); background:var(--paper); border:1px solid var(--line);
  }
  .ticket .bar{ background:var(--header); padding:10px 18px; font-weight:900; letter-spacing:.14em; text-transform:uppercase; }
  .ticket .row{ display:grid;grid-template-columns:1fr 1px 340px;align-items:stretch; gap:0; position:relative; }
  .perforation{ width:1px;background:repeating-linear-gradient(#0000 0 8px, rgba(17,24,39,.22) 8px 12px); }
  .col-left{padding:18px;display:grid;grid-template-columns:1fr 1fr;gap:16px;position:relative}
  .field{font-size:12px;color:var(--muted);letter-spacing:.08em}
  .big-iata{font-size:32px;font-weight:900;line-height:1}
  .city{font-size:12px;margin-top:2px}
  .map{ grid-column:1/-1;margin-top:10px;border:1px dashed rgba(17,24,39,.18); border-radius:14px;height:110px;display:grid;place-items:center;background:#fff;position:relative; }
  .map svg{width:92%;height:auto}
  .ticket-route{fill:none;stroke:#111827;stroke-width:1.5;stroke-linecap:round;stroke-dasharray:6 8;opacity:.45}

  .col-right{padding:18px;background:#fff;display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .label{font-size:12px;color:var(--muted);letter-spacing:.08em}
  .value{font-weight:800}
  .barcode{grid-column:1/-1;height:40px;border-radius:8px;border:1px solid rgba(17,24,39,.12);
    background:repeating-linear-gradient(90deg,#111827 0 2px, transparent 2px 4px),#fff}

  .next{ margin:2px 0 6px; border-radius:18px;border:1px solid var(--line);background:#fff;box-shadow:var(--shadow); overflow:hidden; }
  .next h3{ margin:0; padding:2px 12px; font-size:18px; line-height:1; border:0; }
  .next-list{ display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:0; margin:0; border-top:1px solid var(--line); }
  @media (max-width:780px){.next-list{grid-template-columns:1fr}}
  .next-item{ display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:12px; padding:6px 12px 4px; }
  .next-item:last-child{ padding-bottom:4px; }
  .flag{width:46px;height:28px;border-radius:6px;border:1px solid rgba(17,24,39,.18);overflow:hidden;background:#fff;box-shadow:0 6px 16px rgba(17,24,39,.08)}
  .flag img{width:100%;height:100%;object-fit:cover;display:block}
  .next-title{font-weight:800;margin:0}
  .next-sub{margin:2px 0 0;color:var(--muted);font-size:13px}
  .badge{justify-self:end;background:#ecfdf5;border:1px solid #a7f3d0;color:#065f46;border-radius:999px;font-weight:800; padding:6px 10px;font-size:12px}
  .badge.gray{background:#f3f4f6;border-color:#e5e7eb;color:#374151}

  .section-title{margin:16px 0 10px;font-size:20px;font-weight:800;display:flex;align-items:center;gap:10px}
  .section-title::after{content:"";height:1px;background:var(--line);flex:1}

  .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:18px;position:relative;z-index:1}
  @media (max-width:820px){.grid{grid-template-columns:1fr}}
  .trip{background:#fff;border-radius:18px;border:1px solid var(--line);overflow:hidden;
    box-shadow:var(--shadow);position:relative;transition:transform .18s var(--bezier),box-shadow .18s var(--bezier);
    opacity:0;transform:translateY(12px) scale(.995)}
  .trip.in-view{opacity:1;transform:translateY(0) scale(1)}
  .trip:hover{transform:translateY(-2px);box-shadow:0 16px 40px rgba(17,24,39,.16)}
  .trip .date{position:absolute;top:10px;left:10px;background:rgba(17,24,39,.86);color:#fff;border-radius:999px; padding:6px 10px;font-size:12px}
  .trip img{width:100%;height:320px;object-fit:cover;display:block}
  .trip .meta{padding:12px 14px 14px}
  .trip h3{margin:0 0 4px 0;font-size:18px}
  .trip p{margin:0;color:var(--muted);font-size:14px}

  .lightbox{position:fixed;inset:0;display:none;place-items:center;z-index:30;background:rgba(17,24,39,.35); backdrop-filter:blur(4px) saturate(1.05)}
  .lightbox.open{display:grid;animation:fadeIn .25s ease forwards}
  @keyframes fadeIn{from{opacity:0}to{opacity:1}}
  .lb-card{width:min(1020px,92vw);max-height:86vh;display:grid;grid-template-columns:1.15fr .85fr;gap:14px;
    background:linear-gradient(180deg,#fff8ef,#fff4e6);border:1px solid var(--line);border-radius:18px;
    box-shadow:0 30px 80px rgba(17,24,39,.28);overflow:hidden;position:relative;
    transform:translateY(8px) scale(.98);opacity:0;animation:cardIn .32s var(--bezier) forwards .1s}
  @keyframes cardIn{to{transform:translateY(0) scale(1);opacity:1}}
  @media (max-width:920px){.lb-card{grid-template-columns:1fr;max-height:88vh}}
  .lb-left{padding:14px;display:grid;grid-template-rows:auto auto}
  .lb-stage{background:#fff;border-radius:12px;border:1px solid var(--line);display:grid;place-items:center; position:relative;overflow:hidden;height:min(58vh,520px)}
  .lb-stage img{max-width:100%;max-height:100%;object-fit:contain;opacity:0;transition:opacity .2s ease}
  .lb-stage img.show{opacity:1}
  .navbtn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(17,24,39,.75);color:#fff;border:none; border-radius:999px;width:34px;height:34px;display:grid;place-items:center;cursor:pointer}
  .navbtn.left{left:10px}.navbtn.right{right:10px}
  .thumbs{display:flex;gap:8px;overflow:auto;margin-top:10px;padding-bottom:6px}
  .thumbs img{width:62px;height:62px;border-radius:10px;object-fit:cover;border:2px solid transparent;cursor:pointer}
  .thumbs img.active{border-color:#f59e0b}
  .lb-right{padding:16px 18px 18px 6px}
  .lb-title{font-weight:800;font-size:20px;margin:2px 0 2px}
  .lb-sub{color:var(--muted);font-size:13px;margin-bottom:10px}
  .lb-notes{line-height:1.6;font-size:15px;overflow:auto;max-height:calc(86vh - 190px)}
  .lb-close{position:absolute;top:10px;right:10px;border:none;background:#111827;color:#fff;border-radius:999px; width:36px;height:36px;font-size:18px;cursor:pointer;box-shadow:0 8px 18px rgba(17,24,39,.2)}

  .zoom-clone{position:fixed;z-index:40;border-radius:14px;object-fit:cover;box-shadow:0 16px 40px rgba(17,24,39,.25); transition:all .45s var(--bezier)}
</style>
</head>
<body>

  <header class="navbar">
    <div class="container nav-inner">
      <a class="brand" href="index.html#top">
        <img src="Snoopy_Welcome.png" alt="Logo">
        <span>Jan Arroyo</span>
      </a>
  
      <nav class="nav-links" aria-label="Primary">
        <a href="index.html#work" aria-label="Work">WORK</a>
        <div class="dropdown" aria-expanded="false">
          <button type="button" aria-haspopup="true" aria-expanded="false" aria-label="Open Just for Fun menu">JUST FOR FUN â–¾</button>
          <div class="dropdown-menu" role="menu" aria-label="Just for Fun">
            <a role="menuitem" href="races.html">Races</a>
            <a role="menuitem" href="bake.html">Bake</a>
            <a role="menuitem" href="travel.html">Travel</a>
          </div>
        </div>
      </nav>
    </div>
  </header>
  
  

  <!-- background dashed route + plane -->
  <svg class="scene" viewBox="0 0 1440 900" preserveAspectRatio="none" aria-hidden="true">
    <path id="routeBG" class="route-dash" d="M80,650 C420,520 760,300 1360,360">
      <animate attributeName="stroke-dashoffset" from="0" to="-220" dur="12s" repeatCount="indefinite"/>
    </path>
    <g>
      <path d="M-8,-3 L8,0 L-8,3 L-2,0 Z" fill="#111827"/>
      <animateMotion dur="16s" repeatCount="indefinite" rotate="auto">
        <mpath href="#routeBG"/>
      </animateMotion>
    </g>
  </svg>

  <main class="container">

    <!-- Boarding-pass header -->
    <section class="ticket" aria-label="Travel boarding pass">
      <div class="bar">BOARDING PASS â€” TRAVEL LOG</div>
      <div class="row">
        <div class="col-left">
          <div>
            <div class="field">FROM:</div>
            <div class="big-iata">LAX</div>
            <div class="city">LOS ANGELES</div>
          </div>
          <div>
            <div class="field">TO:</div>
            <div class="big-iata">EVERYWHERE</div>
            <div class="city">TRAVEL LOG</div>
          </div>

          <div class="map" aria-hidden="true">
            <svg viewBox="0 0 800 400" fill="currentColor">
              <path d="M88 183c13-23 44-45 63-43 10 1 15 13 28 16 15 4 39-12 50-6 16 9-3 39 7 47 11 8 41-17 53-8 16 12-1 56 15 64 23 11 49-54 72-49 12 2 19 28 32 29 12 1 27-22 39-19 14 3 14 33 28 36 15 2 33-31 47-29 19 3 27 55 47 55 21 0 44-60 62-62 19-2 28 55 47 57 13 2 28-20 40-16 9 3 21 26 21 26l-5 55H58l-9-79s13-31 39-44z" opacity=".28"/>
              <path id="ticketRoute" class="ticket-route" d="M140,210 C260,180 380,160 520,180  " />
              <g>
                <path d="M-7,-3 L7,0 L-7,3 L-2,0 Z" fill="#111827"/>
                <animateMotion dur="10s" repeatCount="indefinite" rotate="auto">
                  <mpath href="#ticketRoute"/>
                </animateMotion>
              </g>
            </svg>
          </div>
        </div>

        <div class="perforation" aria-hidden="true"></div>

        <aside class="col-right">
          <div>
            <div class="label">Passenger</div>
            <div class="value">Jan Arroyo</div>
          </div>
          <div>
            <div class="label">Class</div>
            <div class="value">Window-Seat Collector</div>
          </div>
          <div>
            <div class="label">Ticket</div>
            <div class="value">JA-TRAVEL-LOG</div>
          </div>
          <div>
            <div class="label">Origin</div>
            <div class="value">LAX</div>
          </div>
          <div class="barcode" aria-hidden="true"></div>
        </aside>
      </div>
    </section>

    <!-- Next up -->
    <section class="next" aria-label="Upcoming trips">
      <h3>Next up</h3>
      <div class="next-list">
        <div class="next-item">
          <div class="flag" aria-hidden="true">
            <img src="https://flagcdn.com/w40/mx.png" alt="">
          </div>
          <div>
            <p class="next-title">Mexico City</p>
            <p class="next-sub">Oct 8 â€¢ LAX â†’ MEX</p>
          </div>
          <div class="badge" id="eta-mex">â€”</div>
        </div>

        <div class="next-item">
          <div class="flag" aria-hidden="true">
            <img src="https://flagcdn.com/w40/kr.png" alt="">
          </div>
          <div>
            <p class="next-title">Seoul, Korea</p>
            <p class="next-sub">Dec 17 â€¢ LAX â†’ ICN</p>
          </div>
          <div class="badge" id="eta-seoul">â€”</div>
        </div>
      </div>
    </section>

    <h2 class="section-title">Trips</h2>

    <section class="grid" id="tripGrid">
      <article
      class="trip reveal"
      data-title="Spain â€” March 2023"
      data-date="Mar 2023"
      data-notes="I went to Spain with the Marshall School of Business to study international commerce and it completely changed how I see business and culture. I learned about the Spanish economy and how customers there value long meals, trust, and tradition instead of the speed and convenience that drive so much of American behavior. It showed me that really knowing your customer means paying attention to culture as much as data, and I left with stronger skills in adaptability, observation, and cross-cultural communication. Outside the classroom is where a lot of the learning happened too. Spending late nights with friends at tapas bars, talking with locals, and exploring cities like Madrid and Barcelona gave me a perspective you cannot get from a textbook. Getting lost together, practicing Spanish, and figuring out the metro taught me problem solving and patience in real time. I built friendships that still last today, and one of the wildest moments was running into Zidane on the streets of Madrid, something that made the trip unforgettable."
      data-images="images/Spain1.JPG|images/spain1.JPG,images/Spain2.JPG|images/spain2.JPG,images/Spain3.JPG|images/spain3.JPG">
      <span class="date">Mar 2023</span>
      <img alt="Spain" src="images/Spain1.JPG" onerror="this.onerror=null;this.src='images/spain1.JPG'">
      <div class="meta"><h3>Spain</h3></div>
    </article>

    <article
    class="trip reveal"
    data-title="New York â€” July 2024"
    data-date="Jul 2024"
    data-notes="I went to New York during my summer internship with Accenture for a client meeting and got the chance to actually present to the client in person which was such a big moment for me. It gave me so much confidence in speaking up and knowing I could handle myself in front of people at that level. Outside of work I was obsessed with the city. Everything moved so fast and I loved the energy of walking through the streets with so much happening around me. I tried bagels that honestly lived up to the hype, spent hours exploring different neighborhoods, and walked across the bridges just taking it all in. I met up with friends too which made the trip even more fun because we just roamed the city at night and laughed way too much. New York really taught me how to adapt quickly, balance the serious work side with just enjoying the moment, and it left me wanting to go back the second I left. ðŸŒ†ðŸ¥¯ðŸ—½"
    data-images="images/NewYork1.JPG,images/NewYork2.JPG,images/NewYork3.JPG,images/NewYork4.JPG,images/NewYork5.JPG">
    <span class="date">Jul 2024</span>
    <img alt="New York" src="images/NewYork1.JPG">
    <div class="meta"><h3>New York</h3></div>
  </article>

  <article
  class="trip reveal"
  data-title="Catalina Island â€” Jan 2025"
  data-date="Jan 2025"
  data-notes="I went to Catalina Island for my one year anniversary with my girlfriend and it honestly felt like we had taken a trip to Europe even though it was just an hour away from Los Angeles. The whole island had this peaceful vibe that made it feel like a real getaway. We explored the place in golf carts which was such a fun way to see everything and it made the trip feel even more unique. Driving around the hills and along the coast gave us views that I still think about. The wild bison roaming around the island were unreal to see up close and made it feel like an adventure. What made it even better was just getting to share it all with her, from quiet mornings by the water to laughing the entire time as we cruised through town. Catalina gave me the perfect mix of relaxation, surprise, and memories Iâ€™ll never forget. ðŸï¸ðŸ¦¬ðŸ’™"
  data-images="images/CatalinaIsland1.JPG|images/Catalinaisland1.JPG|images/Catalinalisland1.JPG,
               images/CatalinaIsland2.JPG|images/Catalinaisland2.JPG|images/Catalinalisland2.JPG,
               images/CatalinaIsland3.JPG|images/Catalinaisland3.JPG|images/Catalinalisland3.JPG">
  <span class="date">Jan 2025</span>
  <img alt="Catalina Island"
       src="images/CatalinaIsland1.JPG"
       onerror="this.onerror=null;this.src='images/Catalinaisland1.JPG';this.onerror=function(){this.src='images/Catalinalisland1.JPG'}">
  <div class="meta"><h3>Catalina Island</h3></div>
</article>

<article
  class="trip reveal"
  data-title="Hawaii â€” March 2025"
  data-date="Mar 2025"
  data-notes="I went to Hawaii for my junior year spring break with friends and it was honestly one of the best trips Iâ€™ve ever had. Every day felt like a new adventure and I still think about it all the time. We spent so much time on the road driving with views that didnâ€™t even feel real and it made every ride unforgettable. The coconuts were a whole different level, drinking them fresh under the sun just hit different. We explored beaches, did short hikes, and ended each day with the kind of sunsets you canâ€™t get anywhere else. What made it even better was being there with my friends because we laughed non stop and made memories I know weâ€™ll talk about for years. Hawaii gave me a mix of pure fun, calm moments, and views Iâ€™ll always miss. ðŸŒºðŸ¥¥ðŸŒŠ"
  data-images="images/Hawaii1.JPG,images/Hawaii2.JPG,images/Hawaii3.JPG,images/Hawaii4.JPG|images/Hawaii.JPG">
  <span class="date">Mar 2025</span>
  <img alt="Hawaii" src="images/Hawaii1.JPG" onerror="this.onerror=null;this.src='images/Hawaii.JPG'">
  <div class="meta"><h3>Hawaii</h3></div>
</article>

    </section>
  </main>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <div class="lb-card" role="dialog" aria-modal="true">
      <button class="lb-close" id="lbClose" aria-label="Close">âœ•</button>
      <div class="lb-left">
        <div class="lb-stage" id="stage">
          <button class="navbtn left" id="prev" aria-label="Previous">â€¹</button>
          <img id="lbImg" alt="">
          <button class="navbtn right" id="next" aria-label="Next">â€º</button>
        </div>
        <div class="thumbs" id="thumbs"></div>
      </div>
      <div class="lb-right">
        <div class="lb-title" id="lbTitle">Trip</div>
        <div class="lb-sub" id="lbDate">Date</div>
        <div class="lb-notes" id="lbNotes">Notes</div>
      </div>
    </div>
  </div>

  <!-- Hover sparkle dot -->
  <div class="hover-dot" id="hoverDot" aria-hidden="true"></div>

<script>
  // ---------- Dropdown (JUST FOR FUN) ---------- (same as index)
  (function(){
    const dd = document.querySelector('.dropdown');
    if(!dd) return;
    const btn = dd.querySelector('button');
    const menu = dd.querySelector('.dropdown-menu');

    function set(open){
      dd.setAttribute('aria-expanded', open ? 'true' : 'false');
      btn.setAttribute('aria-expanded', open ? 'true' : 'false');
    }
    btn.addEventListener('click', (e)=>{ e.stopPropagation(); set(dd.getAttribute('aria-expanded')!=='true'); });
    document.addEventListener('click', ()=> set(false));
    btn.addEventListener('keydown', (e)=>{ if(e.key==='Escape') set(false); });
    menu.addEventListener('keydown', (e)=>{ if(e.key==='Escape') set(false); });
  })();

  // ---------- Hover â€œsparkle/dotâ€ that follows cursor ---------- (same as index)
  (function(){
    const dot = document.getElementById('hoverDot');
    if(!dot) return;
    window.addEventListener('mousemove', (e)=>{
      dot.style.transform = `translate3d(${e.clientX - dot.offsetWidth/2}px, ${e.clientY - dot.offsetHeight/2}px, 0)`;
    }, {passive:true});
    const growTargets = 'a, button, .row, .nav-arrow, .btn';
    document.addEventListener('mouseover', (e)=>{
      if (e.target && (e.target.closest && e.target.closest(growTargets))) {
        dot.classList.add('dot-grow');
      }
    });
    document.addEventListener('mouseout', (e)=>{
      if (e.target && (e.target.closest && e.target.closest(growTargets))) {
        dot.classList.remove('dot-grow');
      }
    });
  })();

  // ---------- Active nav behavior ---------- (same as index)
  (function(){
    const path = (location.pathname || '').toLowerCase();
    const workLink = document.querySelector('.nav-links a[href="#work"]');
    const funBtn   = document.querySelector('.nav-links .dropdown > button');

    // On fun pages (this page), highlight JUST FOR FUN (red + star)
    const onFunPage = /races\.html|bake\.html|travel\.html/.test(path);
    if (onFunPage && funBtn) {
      funBtn.classList.add('active');
    } else if (workLink) {
      const work = document.getElementById('work');
      if (work) {
        const io = new IntersectionObserver((entries)=>{
          entries.forEach(en=>{
            if (en.isIntersecting && en.intersectionRatio > 0.35) workLink.classList.add('active');
            else workLink.classList.remove('active');
          });
        }, {threshold:[0,0.35,1]});
        io.observe(work);
      }
    }
  })();
</script>

<script>
  /* ===== original travel JS (unchanged) ===== */
  const io = new IntersectionObserver((entries)=>{
    entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('in-view'); io.unobserve(e.target);} });
  },{threshold:.2, rootMargin:"-10% 0px -10% 0px"});
  document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

  function pick(paths, cb){
    const list=(paths||"").split('|').map(s=>s.trim()).filter(Boolean);
    if(!list.length){ cb(""); return; }
    let i=0, img=new Image();
    (function tryNext(){
      if(i>=list.length){ cb(list[0]); return; }
      img=new Image();
      img.onload=()=>cb(list[i]);
      img.onerror=()=>{ i++; tryNext(); };
      img.src=list[i];
    })();
  }

  const cards=document.querySelectorAll('.trip');
  const lb=document.getElementById('lightbox');
  const lbImg=document.getElementById('lbImg');
  const lbTitle=document.getElementById('lbTitle');
  const lbDate=document.getElementById('lbDate');
  const lbNotes=document.getElementById('lbNotes');
  const thumbs=document.getElementById('thumbs');
  const stage=document.getElementById('stage');

  let current=[], index=0;

  function openFromCard(card){
    const raw=card.dataset.images.split(',').map(s=>s.trim());
    const resolved=[]; let done=0;
    raw.forEach((entry,k)=>pick(entry,(ok)=>{ resolved[k]=ok; done++; if(done===raw.length){ showLB(card,resolved.filter(Boolean)); }}));
  }

  function showLB(card,list){
    current=list; index=0;
    lbTitle.textContent=card.dataset.title||''; lbDate.textContent=card.dataset.date||''; lbNotes.textContent=card.dataset.notes||'';

    const openerImg=card.querySelector('img');
    const srcRect=openerImg.getBoundingClientRect();
    const clone=openerImg.cloneNode(true);
    clone.className='zoom-clone';
    Object.assign(clone.style,{top:srcRect.top+'px',left:srcRect.left+'px',width:srcRect.width+'px',height:srcRect.height+'px'});
    document.body.appendChild(clone);

    lb.classList.add('open');
    lb.setAttribute('aria-hidden','false');
    const tgtRect=stage.getBoundingClientRect();
    requestAnimationFrame(()=>{
      Object.assign(clone.style,{
        top:(tgtRect.top+10)+'px', left:(tgtRect.left+10)+'px',
        width:(tgtRect.width-20)+'px', height:(tgtRect.height-20)+'px', borderRadius:'12px'
      });
    });
    clone.addEventListener('transitionend',()=>{ clone.remove(); renderStage(); renderThumbs(); },{once:true});
  }

  function renderStage(){
    if(!current.length) return;
    lbImg.classList.remove('show');
    lbImg.onload=()=>lbImg.classList.add('show');
    lbImg.src=current[index];
    [...thumbs.children].forEach((t,i)=>t.classList.toggle('active',i===index));
  }
  function renderThumbs(){
    thumbs.innerHTML='';
    current.forEach((src,i)=>{
      const im=new Image(); im.src=src; if(i===index) im.classList.add('active');
      im.addEventListener('click',()=>{ index=i; renderStage(); });
      thumbs.appendChild(im);
    });
  }
  function closeLB(){
    lb.classList.remove('open');
    lb.setAttribute('aria-hidden','true');
    lbImg.src=''; thumbs.innerHTML='';
  }
  document.getElementById('prev').addEventListener('click',()=>{ index=(index-1+current.length)%current.length; renderStage(); });
  document.getElementById('next').addEventListener('click',()=>{ index=(index+1)%current.length; renderStage(); });
  document.getElementById('lbClose').addEventListener('click',closeLB);
  lb.addEventListener('click',(e)=>{ if(e.target===lb) closeLB(); });
  document.addEventListener('keydown',(e)=>{
    if(!lb.classList.contains('open')) return;
    if(e.key==='Escape') closeLB();
    if(e.key==='ArrowLeft') document.getElementById('prev').click();
    if(e.key==='ArrowRight') document.getElementById('next').click();
  });
  cards.forEach(c=>c.addEventListener('click',()=>openFromCard(c)));

  function setCountdown(el, dateStr){
    const elmt=document.getElementById(el);
    const target=new Date(dateStr);
    function update(){
      const now=new Date();
      const diff=target-now;
      if(diff<=0){ elmt.textContent='Soon'; return; }
      const days=Math.ceil(diff/86400000);
      elmt.textContent = days===1 ? 'in 1 day' : `in ${days} days`;
    }
    update(); setInterval(update, 3600*1000);
  }
  setCountdown('eta-mex',   '2025-10-08T00:00:00');
  setCountdown('eta-seoul', '2025-12-17T00:00:00');

  document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
</script>
</body>
</html>
